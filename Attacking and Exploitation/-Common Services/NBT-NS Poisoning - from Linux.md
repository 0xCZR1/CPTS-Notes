LLMNR and NB will try to resolve the dns request if otherwise is not found.

With Responder:
Responder is fundamentally a poisoning tool that exploits how Windows systems try to automatically discover network resources. Think of it like setting up a fake information desk in a building - when people come asking for directions, it pretends to be legitimate but actually records their credentials.

Here's how it works step by step:

When a Windows system tries to find network resources, it uses several protocols:

1. LLMNR (Link-Local Multicast Name Resolution)
2. NBT-NS (NetBIOS Name Service)
3. MDNS (Multicast DNS)

These protocols are used when DNS fails. For example, if you try accessing "\fileserver" but DNS can't resolve it, Windows falls back to these protocols by broadcasting "Does anyone know where fileserver is?" to the entire network.

This is where Responder steps in. When it sees these broadcasts, it says "Yes, I'm the server you're looking for!" The Windows system, trusting this response, attempts to authenticate to what it believes is the legitimate server.

During the authentication process, Windows sends an NTLMv2 hash. This happens because Windows systems use NTLM authentication by default for network resources. The hash isn't the actual password - it's a challenge-response authentication attempt that includes:

- The username
- The NTLM hash of the user's password
- A random challenge value
- A timestamp

```bash
sudo responder -I ens224 
```

```bash
hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt 
```

Responder can capture these hashes through several fake servers it runs simultaneously:

- SMB (file sharing)
- HTTP/HTTPS (web services)
- WPAD (web proxy)
- FTP
- LDAP
- DNS
- MSSQL

The captured NTLMv2 hash can then be cracked offline using tools like Hashcat because even though the hash includes random elements, the structure is known and the original password can be determined through brute force or dictionary attacks.

The real power of Responder comes from combining different attack vectors. For instance:

1. It can poison WPAD requests, making systems think it's their web proxy
2. This forces systems to attempt NTLM authentication
3. The credentials are captured even if the user isn't actively trying to access network resources

To prevent Responder attacks, organizations typically:

- Disable LLMNR and NBT-NS
- Implement network segmentation
- Use strong passwords that resist offline cracking
- Enable SMB signing
- Use LDAP signing and channel binding

Understanding how Responder works helps security professionals both in attacking and defending networks, as it highlights the importance of secure network discovery protocols and proper authentication mechanisms.