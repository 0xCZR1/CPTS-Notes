Related articles: 
Tags: #Protocols #AnchorPoint 

---
## ðŸ“š Definition:
Simple Network Management Protocol abbreviated SNMP is a lightweight protocol that follows a client-server architecture and is used for communication between systems across a network, by collecting and managing the information.
It operates at port 161 UDP and 162 UDP for traps. 

At the core of the protocol lies the MIB, Management Information Base which holds the information in regards of the the network device. It follows a tree-hierarchy structure, each point/index, also known as Object Identifiers are referring to a set of information, e.g. 1.3.6.1.2.1.1.1 refers to the system description (sysDescr) and value 1.3.6.1.2.1.1.6 refers to the system location (sysLocation).
In order to successfully query one of these OIDs (Object Identifiers) we have to specify each point in the three starting from the root 1 (1.3.6.1.2.1.1.6).
# SNMP MIB Trees

- 1.3.6.1.2.1.25.1.6.0 - System Processes
    
- 1.3.6.1.2.1.25.4.2.1.2 - Running Programs
    
- 1.3.6.1.2.1.25.4.2.1.4 - Processes Path
    
- 1.3.6.1.2.1.25.2.3.1.4 - Storage Units
    
- 1.3.6.1.2.1.25.6.3.1.2 - Software Name
    
- 1.3.6.1.4.1.77.1.2.25 - User Accounts
    
- 1.3.6.1.2.1.6.13.1.3 - TCP Local Ports
- 1.3.6.1.2.1.25.4.2 - hrSWRunParams


---

# ENUMERATING

# Tools:

## NMAP:
We can query SNMP via NMAP:
```bash
sudo nmap -sU -p161 -sVC --script=snmp* 10.13.13.55
```
![[Pasted image 20240827003838.png]]
### Brute-Forcing Community Strings with NMAP:
```bash
sudo nmap -sU -p 161 --script snmp-brute --script-args snmp-brute.communitiesdb=wordlistÂ 10.13.13.55
```
![[Pasted image 20240827004454.png]]

---

## SNMPWALK:
We can query a community string and a given OID via snmpwalk:
![[Pasted image 20240827003715.png]]
![[Pasted image 20240827004039.png]]
![[Pasted image 20240827004135.png]]
We can enumerate installed software:  
```bash
snmpwalk -v2c -c publicÂ IPÂ hrSWInstalledName
```

We can enumerate the ram memory:  
```bash
snmpwalk -v2c -c publicÂ IPÂ hrMemorySize
```

![[Pasted image 20240827004736.png]]

---

# ONESIXTYONE:

We can brute-force via:
```bash
onesixtyone -c dict.txtÂ IP
```

```bash
onesixtyone -cÂ dict.txtÂ -iÂ hostlist.txt
```

![[Pasted image 20240827005323.png]]


